# å°ç§Ÿäº‘å¹³å°å¤šæœåŠ¡æ¶æ„è®¾è®¡æ–¹æ¡ˆ

## ç›®å½•

- [ä¸€ã€æ–¹æ¡ˆæ¦‚è¿°](#ä¸€æ–¹æ¡ˆæ¦‚è¿°)
- [äºŒã€é¡¹ç›®æ•´ä½“ç»“æ„](#äºŒé¡¹ç›®æ•´ä½“ç»“æ„)
- [ä¸‰ã€æ¨¡å—ä¾èµ–é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ](#ä¸‰æ¨¡å—ä¾èµ–é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ)
- [å››ã€æœåŠ¡é—´è°ƒç”¨ä¸éƒ¨ç½²æ¶æ„](#å››æœåŠ¡é—´è°ƒç”¨ä¸éƒ¨ç½²æ¶æ„)
- [äº”ã€æœåŠ¡å¯åŠ¨é…ç½®](#äº”æœåŠ¡å¯åŠ¨é…ç½®)
- [å…­ã€å¼€å‘è§„èŒƒ](#å…­å¼€å‘è§„èŒƒ)
- [ä¸ƒã€éƒ¨ç½²æ–¹æ¡ˆ](#ä¸ƒéƒ¨ç½²æ–¹æ¡ˆ)
- [å…«ã€æ³¨æ„äº‹é¡¹](#å…«æ³¨æ„äº‹é¡¹)

---

## ä¸€ã€æ–¹æ¡ˆæ¦‚è¿°

### 1.1 ä¸šåŠ¡èƒŒæ™¯

å°ç§Ÿäº‘æ˜¯ä¸€ä¸ª **B2BåŠå…¬äº§å“ç§Ÿèµå¹³å°**ï¼Œä¸»è¦ä¸šåŠ¡æµç¨‹å¦‚ä¸‹ï¼š

```
é”€å”®/åˆä¼™äººåˆ›å»ºå®¢æˆ· â†’ ä¸Šä¼ å®¢æˆ·ä¿¡æ¯ â†’ åˆ›å»ºè®¢å• â†’ é£æ§å®¡æ ¸ â†’ åˆå®¡é€šè¿‡
â†’ åˆ›å»ºåˆåŒ&é¦–ä»˜è´¦å• â†’ ç»ˆå®¡é€šè¿‡&æ”¯ä»˜&ç­¾ç½² â†’ ä¾›åº”é“¾åˆ†é…ä¾›åº”å•† â†’ ä¾›åº”å•†æ¥å•
â†’ å‘è´§ â†’ å®¢æˆ·ç¡®è®¤æ”¶è´§ â†’ é¦–ä»˜åˆ†è´¦ â†’ è®¢å•åœ¨ç§Ÿ â†’ æ¯æœˆåˆ›å»ºè´¦å•æ”¶ç§Ÿé‡‘
â†’ æ”¯ä»˜åç»™ä¾›åº”å•†åˆ†è´¦ï¼ˆå¾ªç¯ï¼‰
```

**æ ¸å¿ƒä¸šåŠ¡ç‰¹ç‚¹**ï¼š
- ğŸ“‹ B2Bä¸šåŠ¡æ¨¡å¼ï¼Œé¢å‘ä¼ä¸šå®¢æˆ·
- ğŸ¢ åŠå…¬äº§å“ç§Ÿèµï¼ˆç”µè„‘ã€æ‰“å°æœºã€åŠå…¬å®¶å…·ç­‰ï¼‰
- ğŸ‘¥ å¤šè§’è‰²ååŒï¼ˆé”€å”®ã€é£æ§ã€ä¾›åº”é“¾ã€è´¢åŠ¡ã€ä¾›åº”å•†ï¼‰
- ğŸ’° å¤æ‚çš„åˆ†è´¦ä½“ç³»ï¼ˆé”€å”®åˆ†è´¦ã€ä¾›åº”å•†åˆ†è´¦ï¼‰
- ğŸ”„ é•¿å‘¨æœŸä¸šåŠ¡ï¼ˆæœˆç§Ÿæ¨¡å¼ï¼‰

### 1.2 è®¾è®¡ç›®æ ‡

é‡‡ç”¨ **å¤šå¯åŠ¨æ¨¡å— + ä¸šåŠ¡æ¨¡å—æŒ‰éœ€å¼•å…¥** çš„æ¶æ„æ¨¡å¼ï¼Œå®ç°ï¼š
- ä¸€å¥—å…±äº«çš„ä¸šåŠ¡æ¨¡å—ä»£ç ï¼ˆxzy-modulesï¼‰
- å¤šä¸ªç‹¬ç«‹çš„å¯åŠ¨å…¥å£ï¼ˆxzy-serversï¼‰ï¼ŒæŒ‰ä¸šåŠ¡è§’è‰²æ‹†åˆ†æœåŠ¡
- æ¯ä¸ªæœåŠ¡æŒ‰éœ€å¼•å…¥ä¸šåŠ¡æ¨¡å—ä¾èµ–
- é€šè¿‡Spring Profileå’Œæ¡ä»¶æ³¨è§£æ§åˆ¶ç»„ä»¶åŠ è½½

### 1.3 æ ¸å¿ƒä¼˜åŠ¿

âœ… **ä»£ç å¤ç”¨æ€§é«˜**ï¼šä¸šåŠ¡æ¨¡å—åœ¨å¤šä¸ªæœåŠ¡é—´å…±äº«
âœ… **ç»´æŠ¤æˆæœ¬ä½**ï¼šç»Ÿä¸€ä»£ç åº“ï¼Œä¿®æ”¹ä¸€å¤„å…¨éƒ¨ç”Ÿæ•ˆ
âœ… **çµæ´»æ€§å¼º**ï¼šå¯ä»¥æ ¹æ®éœ€è¦ç»„åˆä¸åŒæ¨¡å—
âœ… **æ‰©å±•æ€§å¥½**ï¼šæ–°å¢æœåŠ¡åªéœ€åˆ›å»ºæ–°çš„å¯åŠ¨æ¨¡å—
âœ… **ç¬¦åˆå¾®æœåŠ¡ç†å¿µ**ï¼šæ¯ä¸ªæœåŠ¡ç‹¬ç«‹éƒ¨ç½²ã€ç‹¬ç«‹æ‰©å®¹
âœ… **è§’è‰²éš”ç¦»æ¸…æ™°**ï¼šä¸åŒè§’è‰²ä½¿ç”¨ä¸åŒçš„æœåŠ¡å…¥å£

## äºŒã€é¡¹ç›®æ•´ä½“ç»“æ„

### 2.1 æ¨èç›®å½•ç»“æ„

```
xzy/
â”œâ”€â”€ xzy-admin/                    # ã€ä¿ç•™ã€‘ç®¡ç†åå°å¯åŠ¨å…¥å£ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ xzy-servers/                  # ã€æ–°å¢ã€‘å¤šæœåŠ¡å¯åŠ¨æ¨¡å—ï¼ˆæŒ‰å†…å¤–éƒ¨è§’è‰²æ‹†åˆ†ï¼‰
â”‚   â”œâ”€â”€ xzy-server-oa/           # OAç®¡ç†æœåŠ¡ï¼ˆå†…éƒ¨ï¼šç®¡ç†å‘˜+ä¾›åº”é“¾+è´¢åŠ¡ï¼‰
â”‚   â”œâ”€â”€ xzy-server-sales/        # é”€å”®/åˆä¼™äººæœåŠ¡ï¼ˆå¤–éƒ¨ï¼šé”€å”®ã€åˆä¼™äººï¼‰
â”‚   â”œâ”€â”€ xzy-server-risk/         # é£æ§æœåŠ¡ï¼ˆå†…éƒ¨ï¼šé£æ§äººå‘˜ï¼Œç‹¬ç«‹å®¡æ ¸ï¼‰
â”‚   â”œâ”€â”€ xzy-server-customer/     # å®¢æˆ·æœåŠ¡ï¼ˆå¤–éƒ¨ï¼šä¼ä¸šå®¢æˆ·Bç«¯ï¼‰
â”‚   â””â”€â”€ xzy-server-supplier/     # ä¾›åº”å•†é—¨æˆ·æœåŠ¡ï¼ˆå¤–éƒ¨ï¼šä¾›åº”å•†ï¼‰
â”œâ”€â”€ xzy-modules/                  # ä¸šåŠ¡æ¨¡å—ï¼ˆå…±äº«ï¼‰
â”‚   â”œâ”€â”€ xzy-api/                 # ã€æ ¸å¿ƒã€‘æ¨¡å—APIæŠ½è±¡å±‚
â”‚   â”‚   â”œâ”€â”€ xzy-system-api/     # ç³»ç»Ÿæ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-customer-api/   # å®¢æˆ·æ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-goods-api/      # å•†å“æ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-supplier-api/   # ä¾›åº”å•†æ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-order-api/      # è®¢å•æ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-partner-api/    # åˆä¼™äººæ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-contract-api/   # åˆåŒæ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-bill-api/       # è´¦å•æ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-fulfillment-api/ # å±¥çº¦æ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-settlement-api/ # åˆ†è´¦æ¨¡å—API
â”‚   â”‚   â”œâ”€â”€ xzy-risk-api/       # é£æ§æ¨¡å—API
â”‚   â”‚   â””â”€â”€ xzy-report-api/     # æŠ¥è¡¨æ¨¡å—API
â”‚   â”‚
â”‚   â”œâ”€â”€ ã€L1 åŸºç¡€æ¨¡å—å±‚ã€‘- ä¸ä¾èµ–å…¶ä»–ä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ xzy-system/              # ç³»ç»Ÿç®¡ç†æ¨¡å—ï¼ˆç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰
â”‚   â”œâ”€â”€ xzy-customer/            # å®¢æˆ·æ¨¡å—
â”‚   â”œâ”€â”€ xzy-goods/               # å•†å“æ¨¡å—
â”‚   â”œâ”€â”€ xzy-supplier/            # ä¾›åº”å•†æ¨¡å—
â”‚   â”œâ”€â”€ xzy-partner/             # åˆä¼™äººæ¨¡å—ï¼ˆé”€å”®ã€åˆ†æˆæ¯”ä¾‹ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ ã€L2 ä¸šåŠ¡æ¨¡å—å±‚ã€‘- å¯ä¾èµ–L1çš„API
â”‚   â”œâ”€â”€ xzy-order/               # è®¢å•ä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ xzy-contract/            # åˆåŒä¸šåŠ¡æ¨¡å—
â”‚   â”‚
â”‚   â”œâ”€â”€ ã€L3 èšåˆæ¨¡å—å±‚ã€‘- å¯ä¾èµ–L1ã€L2çš„API
â”‚   â”œâ”€â”€ xzy-bill/                # è´¦å•ä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ xzy-fulfillment/         # å±¥çº¦å‘è´§æ¨¡å—
â”‚   â”œâ”€â”€ xzy-settlement/          # åˆ†è´¦ç»“ç®—æ¨¡å—
â”‚   â”œâ”€â”€ xzy-risk/                # é£æ§ä¸šåŠ¡æ¨¡å—
â”‚   â””â”€â”€ xzy-report/              # ç»Ÿè®¡æŠ¥è¡¨æ¨¡å—
â”‚
â”œâ”€â”€ xzy-common/                   # å…¬å…±æ¨¡å—ï¼ˆæ‰€æœ‰æœåŠ¡å…±äº«ï¼‰
â””â”€â”€ xzy-extend/                   # æ‰©å±•æ¨¡å—
```

### 2.2 æœåŠ¡ä¸æ¨¡å—ä¾èµ–å…³ç³»è¡¨

| æœåŠ¡åç§° | å¯åŠ¨æ¨¡å— | å¼•å…¥çš„ä¸šåŠ¡æ¨¡å— | ç«¯å£ | ä½¿ç”¨è§’è‰² | æ ¸å¿ƒåŠŸèƒ½ |
|---------|---------|---------------|------|---------|---------|
| **OAç®¡ç†æœåŠ¡** | xzy-server-oa | system, customer, goods, supplier, partner, order, contract, bill, settlement, fulfillment, report | 8081 | **å†…éƒ¨ç®¡ç†å‘˜<br>æœåŠ¡éƒ¨<br>ä¾›åº”é“¾äººå‘˜<br>è´¢åŠ¡äººå‘˜** | ã€ç®¡ç†å‘˜ã€‘åŸºç¡€æ•°æ®ç®¡ç†ã€ç³»ç»Ÿé…ç½®ã€å…¨å±€æŠ¥è¡¨<br>ã€æœåŠ¡éƒ¨ã€‘åˆ›å»ºå®¢æˆ·/è®¢å•ã€åˆ›å»ºåˆåŒ&é¦–ä»˜è´¦å•ã€æ ¸å¯¹æœˆç§Ÿè´¦å•<br>ã€ä¾›åº”é“¾ã€‘åˆ†é…ä¾›åº”å•†ã€å‘è´§ç®¡ç†ã€æ”¶è´§ç¡®è®¤<br>ã€è´¢åŠ¡ã€‘ç¡®è®¤åˆ†è´¦ç»“ç®— |
| **é”€å”®/åˆä¼™äººæœåŠ¡** | xzy-server-sales | system, partner, customer, order, goods, bill, settlement | 8082 | **é”€å”®<br>åˆä¼™äºº<br>è”è¥åˆ†å…¬å¸** | åˆ›å»ºå®¢æˆ·ã€ä¸Šä¼ èµ„æ–™ã€åˆ›å»ºè®¢å•ã€æŸ¥çœ‹ä¸šç»©ã€æŸ¥çœ‹åˆ†è´¦ |
| **é£æ§æœåŠ¡** | xzy-server-risk | system, risk, order, customer, contract, bill | 8083 | **é£æ§äººå‘˜** | é£æ§åˆå®¡ã€ç»ˆå®¡ã€é£æ§æ¨¡å‹ç®¡ç†ã€å®¡æ ¸è®°å½• |
| **å®¢æˆ·æœåŠ¡** | xzy-server-customer | system, customer, order, goods, bill, contract | 8084 | **ä¼ä¸šå®¢æˆ·ï¼ˆBç«¯ï¼‰** | æŸ¥çœ‹è®¢å•ã€æŸ¥çœ‹è´¦å•ã€æ”¯ä»˜è´¦å•ã€ç­¾ç½²åˆåŒã€ç¡®è®¤æ”¶è´§ |
| **ä¾›åº”å•†é—¨æˆ·æœåŠ¡** | xzy-server-supplier | system, supplier, fulfillment, order, goods, settlement | 8085 | **ä¾›åº”å•†** | æ¥å•ã€å‘è´§ã€æŸ¥çœ‹è®¢å•ã€æŸ¥çœ‹åˆ†è´¦ |

### 2.3 ä¸šåŠ¡æµç¨‹ä¸æ¨¡å—å…³ç³»

ä»¥ä¸‹æ˜¯å®Œæ•´çš„ä¸šåŠ¡æµç¨‹ä¸æ¶‰åŠæ¨¡å—ã€ä½¿ç”¨æœåŠ¡çš„æ˜ å°„å…³ç³»ï¼š

| æµç¨‹æ­¥éª¤ | æ“ä½œè§’è‰² | ä½¿ç”¨çš„æœåŠ¡ | æ¶‰åŠæ¨¡å— | æ¨¡å—èŒè´£ |
|---------|---------|-----------|---------|---------|
| 1ï¸âƒ£ åˆ›å»ºå®¢æˆ· | é”€å”®/åˆä¼™äºº **æˆ–** æœåŠ¡éƒ¨ | é”€å”®æœåŠ¡ **æˆ–** OAæœåŠ¡ | customer | ä¸¤ä¸ªæ¸ é“éƒ½å¯ä»¥åˆ›å»ºå®¢æˆ· |
| 2ï¸âƒ£ ä¸Šä¼ å®¢æˆ·èµ„æ–™ | é”€å”®/åˆä¼™äºº **æˆ–** æœåŠ¡éƒ¨ | é”€å”®æœåŠ¡ **æˆ–** OAæœåŠ¡ | customer | ä¸Šä¼ è¥ä¸šæ‰§ç…§ã€æ³•äººèº«ä»½è¯ç­‰èµ„æ–™ |
| 3ï¸âƒ£ åˆ›å»ºè®¢å• | é”€å”®/åˆä¼™äºº **æˆ–** æœåŠ¡éƒ¨ | é”€å”®æœåŠ¡ **æˆ–** OAæœåŠ¡ | order | ä¾èµ–customer-apiã€goods-apiã€partner-api |
| 4ï¸âƒ£ é£æ§åˆå®¡ | é£æ§äººå‘˜ | é£æ§æœåŠ¡ | risk | ä¾èµ–order-apiã€customer-apiè¿›è¡Œå®¡æ ¸ |
| 5ï¸âƒ£ åˆå®¡é€šè¿‡ | é£æ§äººå‘˜ | é£æ§æœåŠ¡ | risk | æ›´æ–°é£æ§å®¡æ ¸çŠ¶æ€ |
| 6ï¸âƒ£ **åˆ›å»ºåˆåŒ&é¦–ä»˜è´¦å•** | **æœåŠ¡éƒ¨** | **OAæœåŠ¡** | contract, bill | **æœåŠ¡éƒ¨è´Ÿè´£åˆ›å»º**ï¼Œä¾èµ–order-apiã€contract-api |
| 7ï¸âƒ£ ç»ˆå®¡&æ”¯ä»˜&ç­¾ç½² | é£æ§äººå‘˜ã€å®¢æˆ· | é£æ§æœåŠ¡ + å®¢æˆ·æœåŠ¡ | risk, bill, contract | é£æ§ç»ˆå®¡ã€å®¢æˆ·æ”¯ä»˜é¦–ä»˜ã€ç”µå­ç­¾ç«  |
| 8ï¸âƒ£ åˆ†é…ä¾›åº”å•† | ä¾›åº”é“¾äººå‘˜ | OAæœåŠ¡ | fulfillment | ä¾èµ–order-apiã€supplier-apiåˆ†é…ä¾›åº”å•† |
| 9ï¸âƒ£ ä¾›åº”å•†æ¥å• | ä¾›åº”å•† | ä¾›åº”å•†é—¨æˆ·æœåŠ¡ | fulfillment | ä¾›åº”å•†ç¡®è®¤æ¥å• |
| ğŸ”Ÿ å‘è´§ | ä¾›åº”å•† | ä¾›åº”å•†é—¨æˆ·æœåŠ¡ | fulfillment | ä¾›åº”å•†å‘è´§ã€å¡«å†™ç‰©æµä¿¡æ¯ |
| 1ï¸âƒ£1ï¸âƒ£ å®¢æˆ·ç¡®è®¤æ”¶è´§ | å®¢æˆ· | å®¢æˆ·æœåŠ¡ | fulfillment â†’ order | ç¡®è®¤æ”¶è´§åæ›´æ–°è®¢å•çŠ¶æ€ä¸º"åœ¨ç§Ÿ" |
| 1ï¸âƒ£2ï¸âƒ£ **é¦–ä»˜è‡ªåŠ¨åˆ†è´¦** | **ç³»ç»Ÿè‡ªåŠ¨** | **OAæœåŠ¡** | settlement | **ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—åˆ†è´¦**ï¼ˆç»™é”€å”®ã€ä¾›åº”å•†ï¼‰ |
| 1ï¸âƒ£3ï¸âƒ£ **è´¢åŠ¡ç¡®è®¤é¦–ä»˜ç»“ç®—** | **è´¢åŠ¡äººå‘˜** | **OAæœåŠ¡** | settlement | **è´¢åŠ¡å®¡æ ¸ç¡®è®¤åæ‰“æ¬¾** |
| 1ï¸âƒ£4ï¸âƒ£ **æ¯æœˆåˆ›å»ºè´¦å•** | **ç³»ç»Ÿå®šæ—¶ä»»åŠ¡** | **OAæœåŠ¡** | bill | **ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆæœˆç§Ÿè´¦å•** |
| 1ï¸âƒ£5ï¸âƒ£ **æœåŠ¡éƒ¨æ ¸å¯¹è´¦å•** | **æœåŠ¡éƒ¨** | **OAæœåŠ¡** | bill | **æœåŠ¡éƒ¨æ ¸å¯¹è´¦å•ç¡®è®¤æ— è¯¯** |
| 1ï¸âƒ£6ï¸âƒ£ å®¢æˆ·æ”¯ä»˜è´¦å• | å®¢æˆ· | å®¢æˆ·æœåŠ¡ | bill | å®¢æˆ·åœ¨çº¿æ”¯ä»˜æœˆç§Ÿè´¦å• |
| 1ï¸âƒ£7ï¸âƒ£ **æœˆç§Ÿè‡ªåŠ¨åˆ†è´¦** | **ç³»ç»Ÿè‡ªåŠ¨** | **OAæœåŠ¡** | settlement | **ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—åˆ†è´¦**ï¼ˆç»™ä¾›åº”å•†ï¼‰ |
| 1ï¸âƒ£8ï¸âƒ£ **è´¢åŠ¡ç¡®è®¤æœˆç§Ÿç»“ç®—** | **è´¢åŠ¡äººå‘˜** | **OAæœåŠ¡** | settlement | **è´¢åŠ¡å®¡æ ¸ç¡®è®¤åæ‰“æ¬¾** |

**æµç¨‹è¯´æ˜**ï¼š
- æ­¥éª¤ 1-7 å±äº**ç­¾çº¦é˜¶æ®µ**ï¼Œæ¶‰åŠé”€å”®/æœåŠ¡éƒ¨ã€é£æ§ã€åˆåŒã€è´¦å•æ¨¡å—
- æ­¥éª¤ 8-11 å±äº**å±¥çº¦é˜¶æ®µ**ï¼Œæ¶‰åŠä¾›åº”é“¾ã€ä¾›åº”å•†ã€å‘è´§ã€æ”¶è´§æ¨¡å—
- æ­¥éª¤ 12-18 å±äº**ç»“ç®—é˜¶æ®µ**ï¼Œæ¶‰åŠè´¦å•ã€åˆ†è´¦æ¨¡å—ï¼Œä¸”æ­¥éª¤ 14-18 ä¼š**å¾ªç¯æ‰§è¡Œ**ç›´åˆ°ç§ŸæœŸç»“æŸ

**å…³é”®è§’è‰²è¯´æ˜**ï¼š
- **é”€å”®/åˆä¼™äºº** vs **æœåŠ¡éƒ¨**ï¼šéƒ½å¯ä»¥åˆ›å»ºå®¢æˆ·/è®¢å•ï¼Œé”€å”®æ˜¯ä¸»è¦æ¸ é“ï¼ŒæœåŠ¡éƒ¨å¤„ç†ç‰¹æ®Šè®¢å•æˆ–å†…éƒ¨è®¢å•
- **æœåŠ¡éƒ¨èŒè´£**ï¼šåˆ›å»ºåˆåŒ&é¦–ä»˜è´¦å•ï¼ˆæ­¥éª¤6ï¼‰ã€æ ¸å¯¹æœˆç§Ÿè´¦å•ï¼ˆæ­¥éª¤15ï¼‰
- **ç³»ç»Ÿè‡ªåŠ¨ vs è´¢åŠ¡ç¡®è®¤**ï¼šåˆ†è´¦ç”±ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—ï¼ˆæ­¥éª¤12ã€17ï¼‰ï¼Œä½†éœ€è´¢åŠ¡ç¡®è®¤åæ‰æ‰“æ¬¾ï¼ˆæ­¥éª¤13ã€18ï¼‰

**æœåŠ¡åˆ’åˆ†åŸåˆ™**ï¼š
- âœ… **å†…éƒ¨äººå‘˜**ï¼ˆç®¡ç†å‘˜ã€æœåŠ¡éƒ¨ã€ä¾›åº”é“¾ã€è´¢åŠ¡ï¼‰ç»Ÿä¸€ä½¿ç”¨ **OAç®¡ç†æœåŠ¡**
- âœ… **å¤–éƒ¨è§’è‰²**ï¼ˆé”€å”®ã€å®¢æˆ·ã€ä¾›åº”å•†ï¼‰ä½¿ç”¨**ç‹¬ç«‹æœåŠ¡**
- âœ… **é£æ§å®¡æ ¸**ä¿æŒ**ç‹¬ç«‹æœåŠ¡**ï¼ˆå®¡æ ¸ç‹¬ç«‹æ€§ã€å®‰å…¨æ€§è€ƒè™‘ï¼‰

### 2.4 æœåŠ¡è¯¦ç»†åŠŸèƒ½è¯´æ˜

#### 2.4.1 OAç®¡ç†æœåŠ¡ï¼ˆå†…éƒ¨ç»¼åˆç®¡ç†å¹³å°ï¼‰

**ç«¯å£**: 8081
**è§’è‰²**: å†…éƒ¨ç®¡ç†å‘˜ã€æœåŠ¡éƒ¨ã€ä¾›åº”é“¾äººå‘˜ã€è´¢åŠ¡äººå‘˜

**å¼•å…¥æ¨¡å—**:
```
system, customer, goods, supplier, partner, order, contract,
bill, settlement, fulfillment, report
```

**åŠŸèƒ½æ¸…å•**:

**ã€ç®¡ç†å‘˜åŠŸèƒ½ã€‘**
- ç³»ç»Ÿç®¡ç†
  - ç”¨æˆ·ç®¡ç†ã€è§’è‰²ç®¡ç†ã€æƒé™ç®¡ç†
  - èœå•ç®¡ç†ã€å‚æ•°é…ç½®
  - å­—å…¸ç®¡ç†ã€éƒ¨é—¨ç®¡ç†
- åŸºç¡€æ•°æ®ç®¡ç†
  - å®¢æˆ·ç®¡ç†ï¼ˆæŸ¥çœ‹ã€ç¼–è¾‘ã€åˆ é™¤ï¼‰
  - å•†å“ç®¡ç†ï¼ˆå•†å“ç±»ç›®ã€å•†å“ä¿¡æ¯ã€ç§Ÿèµä»·æ ¼ï¼‰
  - ä¾›åº”å•†ç®¡ç†ï¼ˆä¾›åº”å•†èµ„è´¨ã€ä¾›åº”èƒ½åŠ›ï¼‰
  - åˆä¼™äººç®¡ç†ï¼ˆé”€å”®äººå‘˜ã€åˆ†å…¬å¸ç®¡ç†ï¼‰
- è®¢å•ç®¡ç†
  - æŸ¥çœ‹æ‰€æœ‰è®¢å•
  - è®¢å•è¯¦æƒ…æŸ¥çœ‹
  - è®¢å•çŠ¶æ€ç›‘æ§
- ç»Ÿè®¡æŠ¥è¡¨
  - è®¢å•ç»Ÿè®¡æŠ¥è¡¨
  - æ”¶æ¬¾ç»Ÿè®¡æŠ¥è¡¨
  - åˆ†è´¦ç»Ÿè®¡æŠ¥è¡¨
  - ä¸šç»©ç»Ÿè®¡æŠ¥è¡¨

**ã€æœåŠ¡éƒ¨åŠŸèƒ½ã€‘**ï¼ˆæ–°å¢ï¼‰
- å®¢æˆ·è®¢å•ç®¡ç†
  - åˆ›å»ºå®¢æˆ·ï¼ˆä»£æ›¿é”€å”®/åˆä¼™äººï¼‰
  - ä¸Šä¼ å®¢æˆ·èµ„æ–™
  - åˆ›å»ºè®¢å•ï¼ˆå¤„ç†ç‰¹æ®Šè®¢å•æˆ–å†…éƒ¨è®¢å•ï¼‰
  - æŸ¥çœ‹è®¢å•åˆ—è¡¨
- åˆåŒè´¦å•ç®¡ç†
  - åˆ›å»ºåˆåŒï¼ˆé£æ§ç»ˆå®¡é€šè¿‡åï¼‰
  - åˆ›å»ºé¦–ä»˜è´¦å•
  - åˆåŒæ¨¡æ¿ç®¡ç†
- æœˆç§Ÿè´¦å•æ ¸å¯¹
  - æŸ¥çœ‹ç³»ç»Ÿç”Ÿæˆçš„æœˆç§Ÿè´¦å•
  - æ ¸å¯¹è´¦å•ä¿¡æ¯
  - è´¦å•å¼‚å¸¸å¤„ç†
  - ç¡®è®¤è´¦å•æ— è¯¯

**ã€ä¾›åº”é“¾åŠŸèƒ½ã€‘**
- è®¢å•å±¥çº¦
  - å¾…åˆ†é…è®¢å•åˆ—è¡¨
  - åˆ†é…ä¾›åº”å•†
  - ä¾›åº”å•†æ¥å•ç®¡ç†
- å‘è´§ç®¡ç†
  - æŸ¥çœ‹å¾…å‘è´§è®¢å•
  - æŸ¥çœ‹å·²å‘è´§è®¢å•
  - ç‰©æµä¿¡æ¯è·Ÿè¸ª
- æ”¶è´§ç®¡ç†
  - å®¢æˆ·æ”¶è´§ç¡®è®¤
  - æ”¶è´§å¼‚å¸¸å¤„ç†
- WMSä»“åº“ä¸šåŠ¡
  - å…¥åº“ç®¡ç†
  - å‡ºåº“ç®¡ç†
  - åº“å­˜æŸ¥è¯¢
- å”®åç®¡ç†
  - å”®åå·¥å•
  - è®¾å¤‡ç»´ä¿®
  - è®¾å¤‡æ›´æ¢

**ã€è´¢åŠ¡åŠŸèƒ½ã€‘**
- è´¦å•ç®¡ç†
  - æŸ¥çœ‹è´¦å•åˆ—è¡¨
  - è´¦å•æŸ¥è¯¢
  - æ”¶æ¬¾è®°å½•æŸ¥è¯¢
  - é€¾æœŸç®¡ç†
- åˆ†è´¦ç»“ç®—ç®¡ç†ï¼ˆæ ¸å¿ƒï¼‰
  - æŸ¥çœ‹ç³»ç»Ÿè‡ªåŠ¨åˆ†è´¦è®°å½•
  - **å®¡æ ¸ç¡®è®¤é¦–ä»˜åˆ†è´¦**
  - **å®¡æ ¸ç¡®è®¤æœˆç§Ÿåˆ†è´¦**
  - åˆ†è´¦å¯¹è´¦
  - ç¡®è®¤åæ‰“æ¬¾
- è´¢åŠ¡æŠ¥è¡¨
  - æ”¶æ¬¾æŠ¥è¡¨
  - åˆ†è´¦æŠ¥è¡¨
  - åº”æ”¶è´¦æ¬¾æŠ¥è¡¨

#### 2.4.2 é”€å”®/åˆä¼™äººæœåŠ¡

**ç«¯å£**: 8082
**è§’è‰²**: é”€å”®äººå‘˜ã€åˆä¼™äººã€è”è¥åˆ†å…¬å¸

**å¼•å…¥æ¨¡å—**:
```
system, partner, customer, order, goods, bill, settlement
```

**åŠŸèƒ½æ¸…å•**:
- å®¢æˆ·ç®¡ç†
  - åˆ›å»ºå®¢æˆ·
  - ä¸Šä¼ å®¢æˆ·èµ„æ–™ï¼ˆè¥ä¸šæ‰§ç…§ã€æ³•äººèº«ä»½è¯ç­‰ï¼‰
  - ç¼–è¾‘å®¢æˆ·ä¿¡æ¯
  - æˆ‘çš„å®¢æˆ·åˆ—è¡¨
- è®¢å•ç®¡ç†
  - åˆ›å»ºè®¢å•
  - é€‰æ‹©å•†å“
  - å¡«å†™è®¢å•ä¿¡æ¯
  - æˆ‘çš„è®¢å•åˆ—è¡¨
  - è®¢å•è¯¦æƒ…æŸ¥çœ‹
  - è®¢å•çŠ¶æ€è·Ÿè¸ª
- ä¸šç»©æŸ¥çœ‹
  - è®¢å•ä¸šç»©ç»Ÿè®¡
  - åˆ†è´¦è®°å½•æŸ¥è¯¢
  - ä¸šç»©æ’å
- å•†å“æµè§ˆ
  - å•†å“ç±»ç›®æµè§ˆ
  - å•†å“è¯¦æƒ…æŸ¥çœ‹
  - ç§Ÿèµä»·æ ¼æŸ¥è¯¢

#### 2.4.3 é£æ§æœåŠ¡

**ç«¯å£**: 8083
**è§’è‰²**: é£æ§äººå‘˜

**å¼•å…¥æ¨¡å—**:
```
system, risk, order, customer, contract, bill
```

**åŠŸèƒ½æ¸…å•**:
- é£æ§å®¡æ ¸
  - å¾…åˆå®¡è®¢å•åˆ—è¡¨
  - è®¢å•åˆå®¡
  - å¾…ç»ˆå®¡è®¢å•åˆ—è¡¨
  - è®¢å•ç»ˆå®¡
- å®¡æ ¸ç®¡ç†
  - æŸ¥çœ‹å®¢æˆ·èµ„æ–™
  - æŸ¥çœ‹è®¢å•è¯¦æƒ…
  - å¡«å†™å®¡æ ¸æ„è§
  - å®¡æ ¸å†å²è®°å½•
- é£æ§æ¨¡å‹
  - é£æ§è§„åˆ™é…ç½®
  - é£æ§æ¨¡å‹ç®¡ç†
  - é»‘åå•ç®¡ç†
- é£æ§æŠ¥è¡¨
  - å®¡æ ¸é€šè¿‡ç‡ç»Ÿè®¡
  - é£é™©è®¢å•ç»Ÿè®¡
  - é€¾æœŸè®¢å•ç»Ÿè®¡

**ä¸ºä»€ä¹ˆé£æ§ç‹¬ç«‹**:
- âœ… å®¡æ ¸ç‹¬ç«‹æ€§è¦æ±‚ï¼ˆé¿å…åˆ©ç›Šå†²çªï¼‰
- âœ… å®‰å…¨æ€§è€ƒè™‘ï¼ˆç‹¬ç«‹éƒ¨ç½²ã€ç‹¬ç«‹æƒé™ï¼‰
- âœ… ä¸šåŠ¡é‡å¤§æ—¶å¯ç‹¬ç«‹æ‰©å®¹
- âœ… å®¡æ ¸æµç¨‹ä¸å…¶ä»–ä¸šåŠ¡éš”ç¦»

#### 2.4.4 å®¢æˆ·æœåŠ¡ï¼ˆæ–°å¢ï¼‰

**ç«¯å£**: 8084
**è§’è‰²**: ä¼ä¸šå®¢æˆ·ï¼ˆBç«¯ï¼‰

**å¼•å…¥æ¨¡å—**:
```
system, customer, order, goods, bill, contract
```

**åŠŸèƒ½æ¸…å•**:
- è®¢å•ç®¡ç†
  - æˆ‘çš„è®¢å•åˆ—è¡¨
  - è®¢å•è¯¦æƒ…æŸ¥çœ‹
  - è®¢å•è¿›åº¦è·Ÿè¸ª
  - ç¡®è®¤æ”¶è´§
- è´¦å•ç®¡ç†
  - æˆ‘çš„è´¦å•åˆ—è¡¨
  - è´¦å•è¯¦æƒ…æŸ¥çœ‹
  - åœ¨çº¿æ”¯ä»˜è´¦å•
  - æ”¯ä»˜è®°å½•æŸ¥è¯¢
- åˆåŒç®¡ç†
  - æˆ‘çš„åˆåŒåˆ—è¡¨
  - åˆåŒè¯¦æƒ…æŸ¥çœ‹
  - åœ¨çº¿ç­¾ç½²åˆåŒï¼ˆç”µå­ç­¾ç« ï¼‰
  - ä¸‹è½½åˆåŒ
- å•†å“æŸ¥çœ‹
  - æŸ¥çœ‹ç§Ÿèµå•†å“ä¿¡æ¯
  - æŸ¥çœ‹å•†å“è§„æ ¼
- å®¢æˆ·ä¿¡æ¯
  - æŸ¥çœ‹æˆ‘çš„ä¿¡æ¯
  - ä¿®æ”¹è”ç³»æ–¹å¼

**ä½¿ç”¨åœºæ™¯**:
- ğŸ“± **Webåº”ç”¨**ï¼ˆPCç«¯ï¼Œä¼ä¸šå®¢æˆ·ä½¿ç”¨ï¼‰
- ğŸ“± **å°ç¨‹åºåº”ç”¨**ï¼ˆç§»åŠ¨ç«¯ï¼Œæ–¹ä¾¿å®¢æˆ·éšæ—¶æŸ¥çœ‹ï¼‰

#### 2.4.5 ä¾›åº”å•†é—¨æˆ·æœåŠ¡

**ç«¯å£**: 8085
**è§’è‰²**: ä¾›åº”å•†

**å¼•å…¥æ¨¡å—**:
```
system, supplier, fulfillment, order, goods, settlement
```

**åŠŸèƒ½æ¸…å•**:
- è®¢å•ç®¡ç†
  - å¾…æ¥å•è®¢å•åˆ—è¡¨
  - æ¥å•ç¡®è®¤
  - æˆ‘çš„è®¢å•åˆ—è¡¨
  - è®¢å•è¯¦æƒ…æŸ¥çœ‹
- å‘è´§ç®¡ç†
  - å¾…å‘è´§è®¢å•
  - å¡«å†™å‘è´§ä¿¡æ¯
  - å¡«å†™ç‰©æµä¿¡æ¯
  - å‘è´§è®°å½•æŸ¥è¯¢
- åˆ†è´¦æŸ¥çœ‹
  - åˆ†è´¦è®°å½•æŸ¥è¯¢
  - åˆ†è´¦å¯¹è´¦
  - ä¸šç»©ç»Ÿè®¡
- å•†å“ç®¡ç†
  - æŸ¥çœ‹å•†å“ä¿¡æ¯
  - æŸ¥çœ‹ä¾›åº”èƒ½åŠ›
- ä¾›åº”å•†ä¿¡æ¯
  - æŸ¥çœ‹æˆ‘çš„ä¿¡æ¯
  - ä¿®æ”¹è”ç³»æ–¹å¼

## ä¸‰ã€æ¨¡å—ä¾èµ–é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 3.1 æ¨¡å—ä¾èµ–é—®é¢˜åˆ†æ

#### 3.1.1 å…¸å‹çš„ä¾èµ–åœºæ™¯

```
å®¢æˆ·æ¨¡å— â† è®¢å•æ¨¡å— â† è´¦å•æ¨¡å— â† ç»“ç®—æ¨¡å—
   â†‘          â†“
   â””â”€â”€â”€ å•†å“æ¨¡å—
         â†“
      ä¾›åº”å•†æ¨¡å—
```

#### 3.1.2 å››ç§ä¾èµ–é—®é¢˜ç±»å‹

**ç±»å‹1ï¼šå¾ªç¯ä¾èµ–ï¼ˆæœ€å±é™©ï¼‰**

```java
// xzy-customer æ¨¡å—
public class CustomerService {
    @Autowired
    private OrderService orderService; // éœ€è¦ç»Ÿè®¡å®¢æˆ·è®¢å•
}

// xzy-order æ¨¡å—
public class OrderService {
    @Autowired
    private CustomerService customerService; // éœ€è¦å®¢æˆ·ä¿¡æ¯
}
```

âŒ **Mavenç¼–è¯‘ç›´æ¥æŠ¥é”™ï¼Œæ— æ³•æ„å»º**

**ç±»å‹2ï¼šå¼ºè€¦åˆä¾èµ–**

```java
// xzy-bill ä¾èµ– xzy-order
public class BillService {
    @Autowired
    private OrderMapper orderMapper; // ç›´æ¥ä¾èµ–å…¶ä»–æ¨¡å—çš„Mapper
}
```

âŒ **ä»£ç ç´§è€¦åˆï¼Œä¿®æ”¹ä¸€ä¸ªæ¨¡å—å½±å“å…¶ä»–æ¨¡å—**

**ç±»å‹3ï¼šæ•°æ®åº“å¤–é”®ä¾èµ–**

```sql
-- è´¦å•è¡¨
CREATE TABLE bill (
    order_id BIGINT,
    FOREIGN KEY (order_id) REFERENCES `order`(id)
);
```

âŒ **æœåŠ¡æ‹†åˆ†åæ— æ³•è·¨åº“å¤–é”®çº¦æŸ**

**ç±»å‹4ï¼šä¼ é€’ä¾èµ–**

```
ç»“ç®—æ¨¡å— â†’ è´¦å•æ¨¡å— â†’ è®¢å•æ¨¡å— â†’ å®¢æˆ·æ¨¡å—
```

âŒ **ä¾èµ–é“¾è¿‡é•¿ï¼Œå½±å“èŒƒå›´ä¸å¯æ§**

### 3.2 è§£å†³æ–¹æ¡ˆä½“ç³»

#### 3.2.1 æ–¹æ¡ˆ1ï¼šåˆ†å±‚æ¨¡å—è®¾è®¡ï¼ˆåŸºç¡€æ–¹æ¡ˆï¼‰

**æ¨¡å—åˆ†å±‚å®šä¹‰**

```
xzy-modules/
â”œâ”€â”€ ã€L0 å…±äº«æ¨¡å—ã€‘- æŠ½è±¡æ¥å£å±‚
â”‚   â””â”€â”€ xzy-api/             # å„æ¨¡å—APIæ¥å£å®šä¹‰ï¼ˆé‡ç‚¹ï¼ï¼‰
â”‚
â”œâ”€â”€ ã€L1 åŸºç¡€æ¨¡å—å±‚ã€‘- ä¸ä¾èµ–ä»»ä½•ä¸šåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ xzy-customer/        # å®¢æˆ·æ¨¡å—
â”‚   â”œâ”€â”€ xzy-goods/           # å•†å“æ¨¡å—
â”‚   â”œâ”€â”€ xzy-supplier/        # ä¾›åº”å•†æ¨¡å—
â”‚   â””â”€â”€ xzy-system/          # ç³»ç»Ÿæ¨¡å—
â”‚
â”œâ”€â”€ ã€L2 ä¸šåŠ¡æ¨¡å—å±‚ã€‘- å¯ä¾èµ–åŸºç¡€æ¨¡å—API
â”‚   â”œâ”€â”€ xzy-order/           # è®¢å•æ¨¡å—ï¼ˆä¾èµ–ï¼šcustomer-api, goods-apiï¼‰
â”‚   â”œâ”€â”€ xzy-inventory/       # åº“å­˜æ¨¡å—ï¼ˆä¾èµ–ï¼šgoods-apiï¼‰
â”‚   â””â”€â”€ xzy-partner/         # åˆä¼™äººæ¨¡å—ï¼ˆä¾èµ–ï¼šcustomer-apiï¼‰
â”‚
â””â”€â”€ ã€L3 èšåˆæ¨¡å—å±‚ã€‘- å¯ä¾èµ–åŸºç¡€+ä¸šåŠ¡æ¨¡å—API
    â”œâ”€â”€ xzy-bill/            # è´¦å•æ¨¡å—ï¼ˆä¾èµ–ï¼šorder-api, customer-apiï¼‰
    â”œâ”€â”€ xzy-settlement/      # ç»“ç®—æ¨¡å—ï¼ˆä¾èµ–ï¼šbill-api, order-apiï¼‰
    â””â”€â”€ xzy-report/          # æŠ¥è¡¨æ¨¡å—ï¼ˆä¾èµ–ï¼šå¤šä¸ªæ¨¡å—APIï¼‰
```

**æ ¸å¿ƒåŸåˆ™**

- âœ… é«˜å±‚æ¨¡å—å¯ä»¥ä¾èµ–ä½å±‚æ¨¡å—çš„API
- âœ… åŒå±‚æ¨¡å—é€šè¿‡APIæ¥å£é€šä¿¡
- âŒ ä½å±‚æ¨¡å—ä¸èƒ½ä¾èµ–é«˜å±‚æ¨¡å—
- âŒ ç¦æ­¢è·¨å±‚ä¾èµ–
- âŒ ä»»ä½•æ¨¡å—ä¸èƒ½ç›´æ¥ä¾èµ–å…¶ä»–æ¨¡å—çš„å®ç°ï¼Œåªèƒ½ä¾èµ–API

#### 3.2.2 æ–¹æ¡ˆ2ï¼šAPIæ¥å£æŠ½è±¡å±‚ï¼ˆè§£å†³å¾ªç¯ä¾èµ–ï¼‰

**APIæ¨¡å—ç»“æ„**

```
xzy-api/                          # APIæŠ½è±¡å±‚
â”œâ”€â”€ xzy-customer-api/
â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ CustomerDTO.java      # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â””â”€â”€ CustomerQueryDTO.java
â”‚   â””â”€â”€ service/
â”‚       â””â”€â”€ ICustomerApiService.java  # å¯¹å¤–æ¥å£
â”‚
â”œâ”€â”€ xzy-order-api/
â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ OrderDTO.java
â”‚   â”‚   â””â”€â”€ OrderQueryDTO.java
â”‚   â””â”€â”€ service/
â”‚       â””â”€â”€ IOrderApiService.java
â”‚
â””â”€â”€ xzy-goods-api/
    â”œâ”€â”€ dto/
    â”‚   â””â”€â”€ GoodsDTO.java
    â””â”€â”€ service/
        â””â”€â”€ IGoodsApiService.java
```

**å®ç°ç¤ºä¾‹**

**1. APIæ¥å£å®šä¹‰ï¼ˆxzy-customer-apiï¼‰**

```java
package org.dromara.customer.api.service;

/**
 * å®¢æˆ·æ¨¡å—å¯¹å¤–APIæ¥å£
 */
public interface ICustomerApiService {
    /**
     * æ ¹æ®IDè·å–å®¢æˆ·ä¿¡æ¯ï¼ˆä¾›å…¶ä»–æ¨¡å—è°ƒç”¨ï¼‰
     */
    CustomerDTO getCustomerById(Long customerId);

    /**
     * æ‰¹é‡è·å–å®¢æˆ·ä¿¡æ¯
     */
    List<CustomerDTO> listCustomerByIds(List<Long> customerIds);

    /**
     * æ ¡éªŒå®¢æˆ·æ˜¯å¦å­˜åœ¨
     */
    boolean existsCustomer(Long customerId);
}
```

**2. DTOå®šä¹‰ï¼ˆxzy-customer-apiï¼‰**

```java
package org.dromara.customer.api.dto;

import lombok.Data;
import java.io.Serializable;

/**
 * å®¢æˆ·ä¿¡æ¯DTO
 * åªåŒ…å«å¿…è¦å­—æ®µï¼Œä¸æš´éœ²å†…éƒ¨å®ä½“
 */
@Data
public class CustomerDTO implements Serializable {
    private static final long serialVersionUID = 1L;

    /** å®¢æˆ·ID */
    private Long customerId;

    /** å®¢æˆ·å§“å */
    private String customerName;

    /** æ‰‹æœºå· */
    private String phone;

    /** å®¢æˆ·ç­‰çº§ */
    private String level;

    /** å®¢æˆ·ç±»å‹ */
    private String type;
}
```

**3. APIæ¥å£å®ç°ï¼ˆxzy-customerï¼‰**

```java
package org.dromara.customer.service.impl;

import org.dromara.customer.api.service.ICustomerApiService;
import org.dromara.customer.api.dto.CustomerDTO;
import org.springframework.stereotype.Service;

/**
 * å®¢æˆ·æ¨¡å—APIæ¥å£å®ç°
 */
@Service
public class CustomerApiServiceImpl implements ICustomerApiService {

    @Autowired
    private CustomerMapper customerMapper;

    @Override
    public CustomerDTO getCustomerById(Long customerId) {
        Customer customer = customerMapper.selectById(customerId);
        if (customer == null) {
            return null;
        }
        // ä½¿ç”¨MapStructè½¬æ¢
        return MapstructUtils.convert(customer, CustomerDTO.class);
    }

    @Override
    public List<CustomerDTO> listCustomerByIds(List<Long> customerIds) {
        List<Customer> customers = customerMapper.selectBatchIds(customerIds);
        return MapstructUtils.convert(customers, CustomerDTO.class);
    }

    @Override
    public boolean existsCustomer(Long customerId) {
        return customerMapper.selectCount(
            Wrappers.lambdaQuery(Customer.class)
                .eq(Customer::getCustomerId, customerId)
        ) > 0;
    }
}
```

**4. è®¢å•æ¨¡å—è°ƒç”¨ï¼ˆxzy-orderï¼‰**

```java
package org.dromara.order.service.impl;

import org.dromara.customer.api.service.ICustomerApiService;
import org.dromara.customer.api.dto.CustomerDTO;

/**
 * è®¢å•æœåŠ¡å®ç°
 */
@Service
public class OrderServiceImpl extends ServiceImpl<OrderMapper, Order> implements IOrderService {

    // åªä¾èµ–APIæ¥å£ï¼Œä¸ä¾èµ–å…·ä½“å®ç°
    @Autowired
    private ICustomerApiService customerApiService;

    @Autowired
    private IGoodsApiService goodsApiService;

    @Override
    public OrderVo getOrderDetail(Long orderId) {
        Order order = baseMapper.selectById(orderId);
        if (order == null) {
            throw new ServiceException("è®¢å•ä¸å­˜åœ¨");
        }

        // è°ƒç”¨å®¢æˆ·æ¨¡å—APIè·å–å®¢æˆ·ä¿¡æ¯
        CustomerDTO customer = customerApiService.getCustomerById(order.getCustomerId());

        // è°ƒç”¨å•†å“æ¨¡å—APIè·å–å•†å“ä¿¡æ¯
        GoodsDTO goods = goodsApiService.getGoodsById(order.getGoodsId());

        // ç»„è£…è¿”å›VO
        OrderVo vo = MapstructUtils.convert(order, OrderVo.class);
        vo.setCustomerName(customer.getCustomerName());
        vo.setCustomerPhone(customer.getPhone());
        vo.setGoodsName(goods.getGoodsName());

        return vo;
    }
}
```

**5. pom.xmlä¾èµ–é…ç½®**

```xml
<!-- xzy-customer-api æ¨¡å—çš„ pom.xml -->
<artifactId>xzy-customer-api</artifactId>
<description>å®¢æˆ·æ¨¡å—APIæ¥å£</description>

<dependencies>
    <!-- åªä¾èµ–å…¬å…±æ¨¡å— -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-common-core</artifactId>
    </dependency>
</dependencies>
```

```xml
<!-- xzy-customer æ¨¡å—çš„ pom.xml -->
<artifactId>xzy-customer</artifactId>
<description>å®¢æˆ·æ¨¡å—å®ç°</description>

<dependencies>
    <!-- ä¾èµ–è‡ªå·±çš„API -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-customer-api</artifactId>
    </dependency>

    <!-- å…¬å…±æ¨¡å— -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-common-mybatis</artifactId>
    </dependency>
</dependencies>
```

```xml
<!-- xzy-order æ¨¡å—çš„ pom.xml -->
<artifactId>xzy-order</artifactId>
<description>è®¢å•æ¨¡å—å®ç°</description>

<dependencies>
    <!-- ä¾èµ–è‡ªå·±çš„API -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-order-api</artifactId>
    </dependency>

    <!-- åªä¾èµ–å…¶ä»–æ¨¡å—çš„APIæ¥å£ï¼Œä¸ä¾èµ–å®ç°æ¨¡å— -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-customer-api</artifactId>
    </dependency>

    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-goods-api</artifactId>
    </dependency>

    <!-- å…¬å…±æ¨¡å— -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-common-mybatis</artifactId>
    </dependency>
</dependencies>
```

#### 3.2.3 æ–¹æ¡ˆ3ï¼šæ•°æ®å†—ä½™è®¾è®¡ï¼ˆè§£å†³è·¨æœåŠ¡æŸ¥è¯¢ï¼‰

åœ¨è®¢å•è¡¨ä¸­å†—ä½™å®¢æˆ·å’Œå•†å“çš„å…³é”®ä¿¡æ¯ï¼š

```java
package org.dromara.order.domain;

/**
 * è®¢å•å®ä½“
 */
@Data
@TableName("order")
public class Order extends BaseEntity {

    /** è®¢å•ID */
    private Long orderId;

    /** å®¢æˆ·IDï¼ˆå…³è”å­—æ®µï¼‰ */
    private Long customerId;

    /** å•†å“IDï¼ˆå…³è”å­—æ®µï¼‰ */
    private Long goodsId;

    // ========== å†—ä½™å®¢æˆ·ä¿¡æ¯ï¼ˆä¸‹å•æ—¶å†™å…¥ï¼Œé¿å…æŸ¥è¯¢æ—¶å…³è”ï¼‰ ==========
    /** å®¢æˆ·å§“å */
    private String customerName;

    /** å®¢æˆ·æ‰‹æœº */
    private String customerPhone;

    /** å®¢æˆ·ç­‰çº§ */
    private String customerLevel;

    // ========== å†—ä½™å•†å“ä¿¡æ¯ ==========
    /** å•†å“åç§° */
    private String goodsName;

    /** å•†å“è§„æ ¼ */
    private String goodsSpec;

    /** å•†å“å•ä»·ï¼ˆå¿«ç…§ï¼‰ */
    private BigDecimal goodsPrice;

    // ========== è®¢å•ä¿¡æ¯ ==========
    /** è®¢å•é‡‘é¢ */
    private BigDecimal amount;

    /** è®¢å•çŠ¶æ€ */
    private String status;
}
```

**åˆ›å»ºè®¢å•æ—¶å†™å…¥å†—ä½™æ•°æ®**

```java
@Service
public class OrderServiceImpl {

    @Autowired
    private ICustomerApiService customerApiService;

    @Autowired
    private IGoodsApiService goodsApiService;

    @Transactional(rollbackFor = Exception.class)
    public Long createOrder(OrderBo bo) {
        // è·å–å®¢æˆ·ä¿¡æ¯
        CustomerDTO customer = customerApiService.getCustomerById(bo.getCustomerId());
        Assert.notNull(customer, "å®¢æˆ·ä¸å­˜åœ¨");

        // è·å–å•†å“ä¿¡æ¯
        GoodsDTO goods = goodsApiService.getGoodsById(bo.getGoodsId());
        Assert.notNull(goods, "å•†å“ä¸å­˜åœ¨");

        // åˆ›å»ºè®¢å•ï¼Œå†™å…¥å†—ä½™æ•°æ®
        Order order = new Order();
        order.setCustomerId(bo.getCustomerId());
        order.setGoodsId(bo.getGoodsId());

        // å†—ä½™å®¢æˆ·ä¿¡æ¯
        order.setCustomerName(customer.getCustomerName());
        order.setCustomerPhone(customer.getPhone());
        order.setCustomerLevel(customer.getLevel());

        // å†—ä½™å•†å“ä¿¡æ¯ï¼ˆä»·æ ¼å¿«ç…§ï¼‰
        order.setGoodsName(goods.getGoodsName());
        order.setGoodsSpec(goods.getSpec());
        order.setGoodsPrice(goods.getPrice());

        baseMapper.insert(order);
        return order.getOrderId();
    }
}
```

**ä¼˜ç¼ºç‚¹åˆ†æ**

**ä¼˜ç‚¹ï¼š**
- âœ… æŸ¥è¯¢æ€§èƒ½é«˜ï¼ˆä¸éœ€è¦è·¨æ¨¡å—/è·¨æœåŠ¡æŸ¥è¯¢ï¼‰
- âœ… å†å²æ•°æ®ä¸å—å½±å“ï¼ˆå®¢æˆ·æ”¹åä¸å½±å“å†å²è®¢å•ï¼‰
- âœ… é™ä½æ¨¡å—é—´ä¾èµ–

**ç¼ºç‚¹ï¼š**
- âŒ å­˜å‚¨ç©ºé—´å¢åŠ 
- âŒ éœ€è¦ä¿è¯æ•°æ®ä¸€è‡´æ€§
- âŒ éœ€è¦åœ¨å¤šå¤„ç»´æŠ¤ç›¸åŒæ•°æ®

**é€‚ç”¨åœºæ™¯ï¼š**
- è®¢å•ã€è´¦å•ç­‰ä¸šåŠ¡å¿«ç…§
- æ—¥å¿—ã€æŠ¥è¡¨ç­‰ç»Ÿè®¡æ•°æ®
- é«˜é¢‘æŸ¥è¯¢çš„åˆ—è¡¨é¡µé¢

### 3.3 å…·ä½“æ¨¡å—ä¾èµ–è®¾è®¡

#### 3.3.1 æ¨¡å—æ¸…å•å’Œåˆ†å±‚è¡¨

| æ¨¡å—åç§° | æ¨¡å—æ ‡è¯† | å±‚çº§ | å¯ä¾èµ–çš„APIæ¨¡å— | ä¸šåŠ¡èŒè´£ |
|---------|---------|------|----------------|---------|
| **L1 åŸºç¡€æ¨¡å—å±‚** - ä¸ä¾èµ–å…¶ä»–ä¸šåŠ¡æ¨¡å— |
| ç³»ç»Ÿæ¨¡å— | xzy-system | L1 | æ—  | ç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€èœå•ç®¡ç† |
| å®¢æˆ·æ¨¡å— | xzy-customer | L1 | æ—  | å®¢æˆ·åŸºç¡€ä¿¡æ¯ã€å®¢æˆ·èµ„æ–™ä¸Šä¼  |
| å•†å“æ¨¡å— | xzy-goods | L1 | æ—  | åŠå…¬äº§å“ä¿¡æ¯ã€ç§Ÿèµä»·æ ¼ã€å•†å“è§„æ ¼ |
| ä¾›åº”å•†æ¨¡å— | xzy-supplier | L1 | æ—  | ä¾›åº”å•†ä¿¡æ¯ç®¡ç†ã€ä¾›åº”å•†èƒ½åŠ› |
| åˆä¼™äººæ¨¡å— | xzy-partner | L1 | æ—  | é”€å”®äººå‘˜ç®¡ç†ã€åˆä¼™äººä¿¡æ¯ã€åˆ†æˆæ¯”ä¾‹ |
| **L2 ä¸šåŠ¡æ¨¡å—å±‚** - å¯ä¾èµ–L1çš„API |
| è®¢å•æ¨¡å— | xzy-order | L2 | customer-api, goods-api, partner-api | è®¢å•åˆ›å»ºã€è®¢å•çŠ¶æ€æµè½¬ã€è®°å½•é”€å”®äººå‘˜ |
| åˆåŒæ¨¡å— | xzy-contract | L2 | order-api, customer-api | åˆåŒåˆ›å»ºã€åˆåŒç­¾ç½²ã€åˆåŒç®¡ç† |
| **L3 èšåˆæ¨¡å—å±‚** - å¯ä¾èµ–L1ã€L2çš„API |
| é£æ§æ¨¡å— | xzy-risk | L3 | order-api, customer-api, contract-api | é£æ§åˆå®¡ã€ç»ˆå®¡ã€é£æ§æ¨¡å‹ |
| è´¦å•æ¨¡å— | xzy-bill | L3 | order-api, contract-api, customer-api | é¦–ä»˜è´¦å•ã€æœˆç§Ÿè´¦å•ã€è´¦å•æ”¯ä»˜ |
| å±¥çº¦æ¨¡å— | xzy-fulfillment | L3 | order-api, supplier-api, goods-api | åˆ†é…ä¾›åº”å•†ã€æ¥å•ã€å‘è´§ã€æ”¶è´§ç¡®è®¤ |
| åˆ†è´¦æ¨¡å— | xzy-settlement | L3 | bill-api, partner-api, supplier-api, order-api | é¦–ä»˜åˆ†è´¦ã€æœˆç§Ÿåˆ†è´¦ã€ä¾›åº”å•†åˆ†è´¦ |
| æŠ¥è¡¨æ¨¡å— | xzy-report | L3 | order-api, bill-api, settlement-api, partner-api | è®¢å•ç»Ÿè®¡ã€æ”¶æ¬¾ç»Ÿè®¡ã€åˆ†è´¦ç»Ÿè®¡ã€ä¸šç»©ç»Ÿè®¡ |

#### 3.3.2 ä¾èµ–å…³ç³»ç¤ºä¾‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ã€L3 èšåˆæ¨¡å—å±‚ã€‘                         â”‚
â”‚                                                                   â”‚
â”‚   xzy-report â”€â”€â”€â”€â”                                               â”‚
â”‚   (ç»Ÿè®¡æŠ¥è¡¨)      â”‚                                               â”‚
â”‚                  â”‚                                               â”‚
â”‚   xzy-settlement â”œâ”€â”€â†’ xzy-bill â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚   (åˆ†è´¦)          â”‚   (è´¦å•)          â”‚                          â”‚
â”‚                  â”‚                    â”‚                          â”‚
â”‚   xzy-risk â”€â”€â”€â”€â”€â”€â”¤                    â”‚                          â”‚
â”‚   (é£æ§)          â”‚                    â”‚                          â”‚
â”‚                  â”‚                    â”‚                          â”‚
â”‚   xzy-fulfillmentâ”‚                    â”‚                          â”‚
â”‚   (å±¥çº¦å‘è´§)      â”‚                    â”‚                          â”‚
â”‚                  â”‚                    â”‚                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                    â”‚
                   â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ã€L2 ä¸šåŠ¡æ¨¡å—å±‚ã€‘                         â”‚
â”‚                                                                   â”‚
â”‚   xzy-contract â”€â”€â”€â”€â”€â”€â”€â†’ xzy-order â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚   (åˆåŒ)                 (è®¢å•)            â”‚                      â”‚
â”‚                                           â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ã€L1 åŸºç¡€æ¨¡å—å±‚ã€‘                         â”‚
â”‚                                                                   â”‚
â”‚   xzy-system      xzy-customer    xzy-goods                     â”‚
â”‚   (ç³»ç»Ÿ)          (å®¢æˆ·)          (å•†å“)                          â”‚
â”‚                                                                   â”‚
â”‚   xzy-supplier    xzy-partner                                   â”‚
â”‚   (ä¾›åº”å•†)        (åˆä¼™äºº/é”€å”®)                                   â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†‘                   â†‘
                    â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ã€L0 APIæ¥å£å±‚ã€‘                         â”‚
â”‚                                                                   â”‚
â”‚   system-api      customer-api    goods-api                     â”‚
â”‚   supplier-api    partner-api                                   â”‚
â”‚                                                                   â”‚
â”‚   order-api       contract-api                                  â”‚
â”‚                                                                   â”‚
â”‚   bill-api        fulfillment-api    settlement-api             â”‚
â”‚   risk-api        report-api                                    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€è¯´æ˜ã€‘
L1å±‚ï¼š5ä¸ªåŸºç¡€æ¨¡å—ï¼ˆsystem, customer, goods, supplier, partnerï¼‰
L2å±‚ï¼š2ä¸ªä¸šåŠ¡æ¨¡å—ï¼ˆorderä¾èµ–L1çš„3ä¸ªAPIï¼Œcontractä¾èµ–order-apiï¼‰
L3å±‚ï¼š5ä¸ªèšåˆæ¨¡å—ï¼ˆéƒ½ä¾èµ–L1å’ŒL2çš„APIï¼‰
```

## å››ã€æœåŠ¡é—´è°ƒç”¨ä¸éƒ¨ç½²æ¶æ„

### 4.1 æœåŠ¡é—´è°ƒç”¨æ–¹å¼

åœ¨æœ¬æ¶æ„ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨ **æœ¬åœ°APIæ¥å£è°ƒç”¨** çš„æ–¹å¼ï¼Œè¿™æ˜¯æœ€ç®€å•ã€æ€§èƒ½æœ€é«˜çš„è°ƒç”¨æ–¹å¼ã€‚

#### 4.1.1 æœ¬åœ°è°ƒç”¨åŸç†

**æ ¸å¿ƒæ€æƒ³**ï¼šæœåŠ¡ä¹‹é—´é€šè¿‡APIæ¥å£æŠ½è±¡å±‚è¿›è¡Œè°ƒç”¨ï¼Œä½†å®ç°æ˜¯åœ¨åŒä¸€ä¸ªJVMå†…çš„æœ¬åœ°æ–¹æ³•è°ƒç”¨ã€‚

```java
/**
 * APIæ¥å£å®šä¹‰ï¼ˆxzy-customer-apiæ¨¡å—ï¼‰
 */
public interface ICustomerApiService {
    CustomerDTO getCustomerById(Long customerId);
    List<CustomerDTO> listCustomerByIds(List<Long> customerIds);
}

/**
 * APIæ¥å£å®ç°ï¼ˆxzy-customeræ¨¡å—ï¼‰
 */
@Service
public class CustomerApiServiceImpl implements ICustomerApiService {

    @Autowired
    private CustomerMapper customerMapper;

    @Override
    public CustomerDTO getCustomerById(Long customerId) {
        Customer customer = customerMapper.selectById(customerId);
        return MapstructUtils.convert(customer, CustomerDTO.class);
    }
}

/**
 * è®¢å•æœåŠ¡è°ƒç”¨ï¼ˆxzy-orderæ¨¡å—ï¼‰
 */
@Service
public class OrderServiceImpl {

    @Autowired
    private ICustomerApiService customerApiService;  // Springè‡ªåŠ¨æ³¨å…¥æœ¬åœ°å®ç°

    public OrderVo getOrderDetail(Long orderId) {
        Order order = baseMapper.selectById(orderId);

        // æœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼Œæ— ç½‘ç»œå¼€é”€
        CustomerDTO customer = customerApiService.getCustomerById(order.getCustomerId());

        return buildOrderVo(order, customer);
    }
}
```

**è°ƒç”¨æµç¨‹**ï¼š
```
OrderService.getOrderDetail()
    â†“ (æ™®é€šæ–¹æ³•è°ƒç”¨)
ICustomerApiService.getCustomerById()
    â†“ (Springæ³¨å…¥)
CustomerApiServiceImpl.getCustomerById()
    â†“
CustomerMapper.selectById()
    â†“
MySQLæ•°æ®åº“
```

#### 4.1.2 æœ¬åœ°è°ƒç”¨çš„ä¼˜åŠ¿

| ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|
| **æ€§èƒ½æœ€é«˜** | ç›´æ¥æ–¹æ³•è°ƒç”¨ï¼Œè€—æ—¶çº¦0.1msï¼Œæ— ç½‘ç»œå¼€é”€ã€æ— åºåˆ—åŒ–å¼€é”€ |
| **å¼€å‘ç®€å•** | å°±æ˜¯æ™®é€šçš„Spring Beanæ³¨å…¥ï¼Œå’Œå•ä½“åº”ç”¨å¼€å‘ä¸€æ · |
| **è°ƒè¯•æ–¹ä¾¿** | å¯ä»¥ç›´æ¥æ–­ç‚¹è¿›å…¥è°ƒç”¨çš„æ–¹æ³•ï¼Œæ— éœ€å¯åŠ¨å¤šä¸ªæœåŠ¡ |
| **è¿ç»´ç®€å•** | ä¸€ä¸ªjaråŒ…åŒ…å«æ‰€æœ‰åŠŸèƒ½ï¼Œéƒ¨ç½²ã€ç›‘æ§ã€æ—¥å¿—éƒ½å¾ˆç®€å• |
| **æˆæœ¬ä½** | ä¸éœ€è¦æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€ç½‘å…³ç­‰å¾®æœåŠ¡åŸºç¡€è®¾æ–½ |

---

### 4.2 é›†ç¾¤éƒ¨ç½²æ¶æ„

è™½ç„¶ä½¿ç”¨æœ¬åœ°è°ƒç”¨ï¼Œä½†å¯ä»¥é€šè¿‡**é›†ç¾¤éƒ¨ç½²**å®ç°é«˜å¯ç”¨å’Œè´Ÿè½½å‡è¡¡ã€‚

#### 4.2.1 éƒ¨ç½²æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Nginx (è´Ÿè½½å‡è¡¡)                        â”‚
â”‚               192.168.1.100:80                          â”‚
â”‚    upstreamé…ç½®ï¼šip_hash (ä¼šè¯ä¿æŒ)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   åº”ç”¨æœåŠ¡å™¨1       â”‚  â”‚   åº”ç”¨æœåŠ¡å™¨2      â”‚
        â”‚  192.168.1.101     â”‚  â”‚  192.168.1.102    â”‚
        â”‚                    â”‚  â”‚                    â”‚
        â”‚  xzy-admin:8080   â”‚  â”‚  xzy-admin:8080   â”‚
        â”‚  (åŒ…å«æ‰€æœ‰æ¨¡å—)    â”‚  â”‚  (åŒ…å«æ‰€æœ‰æ¨¡å—)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                    â”‚
                  â”‚     å…±äº«åŸºç¡€è®¾æ–½    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                        â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
        â”‚  â”‚  MySQL   â”‚  â”‚  Redis   â”‚          â”‚
        â”‚  â”‚ (ä¸»ä»)   â”‚  â”‚(ç¼“å­˜+Session)â”‚        â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
        â”‚                                        â”‚
        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
        â”‚  â”‚  MinIO   â”‚  â”‚ SnailJob â”‚          â”‚
        â”‚  â”‚ (æ–‡ä»¶)   â”‚  â”‚(å®šæ—¶ä»»åŠ¡) â”‚          â”‚
        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¶æ„è¯´æ˜**ï¼š
- **Nginx**ï¼šè´Ÿè½½å‡è¡¡å™¨ï¼Œå°†ç”¨æˆ·è¯·æ±‚åˆ†å‘åˆ°å¤šå°åº”ç”¨æœåŠ¡å™¨
- **åº”ç”¨æœåŠ¡å™¨**ï¼šè¿è¡Œxzy-adminæˆ–å…¶ä»–æœåŠ¡ï¼Œæ¯å°æœåŠ¡å™¨åŒ…å«å®Œæ•´çš„ä¸šåŠ¡æ¨¡å—
- **å…±äº«åŸºç¡€è®¾æ–½**ï¼šMySQLã€Redisã€MinIOã€SnailJobç­‰ï¼Œæ‰€æœ‰åº”ç”¨æœåŠ¡å™¨å…±äº«

#### 4.2.2 è¯·æ±‚å¤„ç†æµç¨‹

```
ç”¨æˆ·Aè¯·æ±‚ â†’ Nginx â†’ åˆ†é…åˆ°æœåŠ¡å™¨1
                      â†“
            æœåŠ¡å™¨1å¤„ç†æ•´ä¸ªè¯·æ±‚ï¼ˆæœ¬åœ°è°ƒç”¨ï¼‰
            OrderService â†’ CustomerApiService (æœ¬åœ°)
                      â†“
                  è®¿é—®å…±äº«MySQL
                      â†“
                 è¿”å›ç»“æœç»™ç”¨æˆ·A

ç”¨æˆ·Bè¯·æ±‚ â†’ Nginx â†’ åˆ†é…åˆ°æœåŠ¡å™¨2
                      â†“
            æœåŠ¡å™¨2å¤„ç†æ•´ä¸ªè¯·æ±‚ï¼ˆæœ¬åœ°è°ƒç”¨ï¼‰
            OrderService â†’ CustomerApiService (æœ¬åœ°)
                      â†“
                  è®¿é—®å…±äº«MySQL
                      â†“
                 è¿”å›ç»“æœç»™ç”¨æˆ·B
```

**å…³é”®ç‚¹**ï¼š
- âœ… æ¯å°æœåŠ¡å™¨éƒ½æœ‰å®Œæ•´çš„ä¸šåŠ¡æ¨¡å—
- âœ… æ¯å°æœåŠ¡å™¨éƒ½è¿æ¥åŒä¸€ä¸ªæ•°æ®åº“
- âœ… ç”¨æˆ·è¯·æ±‚åˆ°å“ªå°æœåŠ¡å™¨ï¼Œå°±åœ¨é‚£å°æœåŠ¡å™¨ä¸Šå®Œæˆæœ¬åœ°è°ƒç”¨
- âœ… ä¸éœ€è¦è·¨æœåŠ¡å™¨è°ƒç”¨

---

### 4.3 é›†ç¾¤éƒ¨ç½²æ³¨æ„äº‹é¡¹

åœ¨é›†ç¾¤éƒ¨ç½²ä¸‹ï¼Œéœ€è¦è§£å†³ä»¥ä¸‹4ä¸ªé—®é¢˜ï¼š

#### 4.3.1 ä¼šè¯ä¸€è‡´æ€§

**é—®é¢˜**ï¼šç”¨æˆ·ç™»å½•åï¼Œtokenå¯èƒ½åªå­˜åœ¨æŸä¸€å°æœåŠ¡å™¨ä¸Š

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨Rediså­˜å‚¨Session/Tokenï¼ˆRuoYi-Vue-Plusé»˜è®¤æ”¯æŒï¼‰

```yaml
# application.yml
spring:
  # Sessionå­˜å‚¨åˆ°Redis
  session:
    store-type: redis

  data:
    redis:
      host: 192.168.1.200  # å…±äº«Redis
      port: 6379
      database: 0

# Sa-Tokené…ç½®ï¼ˆä½¿ç”¨Rediså­˜å‚¨ï¼‰
sa-token:
  token-name: Authorization
  timeout: 2592000
  # ç‹¬ç«‹Rediså­˜å‚¨token
  alone-redis:
    database: 1
    host: 192.168.1.200
    port: 6379
```

**Nginxé…ç½®**ï¼ˆå¯é€‰ï¼Œä½œä¸ºåŒä¿é™©ï¼‰ï¼š
```nginx
upstream xzy_backend {
    ip_hash;  # åŒä¸€ç”¨æˆ·æ€»æ˜¯åˆ†é…åˆ°åŒä¸€å°æœåŠ¡å™¨
    server 192.168.1.101:8080;
    server 192.168.1.102:8080;
}
```

---

#### 4.3.2 ç¼“å­˜ä¸€è‡´æ€§

**é—®é¢˜**ï¼šä¸¤å°æœåŠ¡å™¨çš„æœ¬åœ°ç¼“å­˜å¯èƒ½ä¸ä¸€è‡´

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨Redisä½œä¸ºå…±äº«ç¼“å­˜ï¼ˆæ¨èï¼‰

```yaml
# application.yml
spring:
  data:
    redis:
      host: 192.168.1.200  # å…±äº«Redis
      port: 6379
      database: 0
```

```java
// ä½¿ç”¨Spring Cache + Redis
@Cacheable(value = "customer", key = "#customerId")
public CustomerDTO getCustomerById(Long customerId) {
    // æ•°æ®è‡ªåŠ¨ç¼“å­˜åˆ°Redisï¼Œä¸¤å°æœåŠ¡å™¨å…±äº«
    Customer customer = customerMapper.selectById(customerId);
    return MapstructUtils.convert(customer, CustomerDTO.class);
}

@CacheEvict(value = "customer", key = "#customerId")
public void updateCustomer(Long customerId, CustomerDTO dto) {
    // æ›´æ–°åè‡ªåŠ¨æ¸…é™¤Redisç¼“å­˜ï¼Œä¸¤å°æœåŠ¡å™¨éƒ½ç”Ÿæ•ˆ
    customerMapper.updateById(customer);
}
```

---

#### 4.3.3 å®šæ—¶ä»»åŠ¡é‡å¤æ‰§è¡Œ

**é—®é¢˜**ï¼šæ¯å°æœåŠ¡å™¨éƒ½ä¼šæ‰§è¡Œå®šæ—¶ä»»åŠ¡ï¼Œå¯¼è‡´é‡å¤æ‰§è¡Œ

**è§£å†³æ–¹æ¡ˆA**ï¼šä½¿ç”¨SnailJobåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ï¼ˆæ¨èï¼‰

RuoYi-Vue-Pluså·²é›†æˆSnailJobï¼Œè‡ªåŠ¨ä¿è¯åªæœ‰ä¸€å°æœåŠ¡å™¨æ‰§è¡Œã€‚

```yaml
# application.yml
snail-job:
  enabled: true
  server: http://192.168.1.200:8088  # SnailJobæœåŠ¡å™¨
```

**è§£å†³æ–¹æ¡ˆB**ï¼šä½¿ç”¨åˆ†å¸ƒå¼é”

```java
@Scheduled(cron = "0 0 0 1 * ?")  // æ¯æœˆ1å·0ç‚¹ç”Ÿæˆè´¦å•
public void generateMonthlyBill() {
    // ä½¿ç”¨Redissonåˆ†å¸ƒå¼é”
    RLock lock = redissonClient.getLock("bill:generate:monthly");

    if (lock.tryLock()) {
        try {
            // åªæœ‰æ‹¿åˆ°é”çš„æœåŠ¡å™¨æ‰§è¡Œ
            billService.generateMonthlyBill();
        } finally {
            lock.unlock();
        }
    }
}
```

---

#### 4.3.4 æ–‡ä»¶ä¸Šä¼ é—®é¢˜

**é—®é¢˜**ï¼šæ–‡ä»¶ä¸Šä¼ åˆ°æŸå°æœåŠ¡å™¨åï¼Œå…¶ä»–æœåŠ¡å™¨è®¿é—®ä¸åˆ°

**è§£å†³æ–¹æ¡ˆ**ï¼šä½¿ç”¨OSSå¯¹è±¡å­˜å‚¨ï¼ˆæ¨èï¼‰

RuoYi-Vue-Pluså·²é›†æˆOSSæ”¯æŒã€‚

```yaml
# application.yml
oss:
  type: minio  # æˆ– aliyun, qiniu, qcloud
  endpoint: http://192.168.1.200:9000
  accessKey: minioadmin
  secretKey: minioadmin
  bucketName: xzy-files
```

```java
// æ–‡ä»¶ä¸Šä¼ åˆ°OSSï¼Œä¸¤å°æœåŠ¡å™¨éƒ½èƒ½è®¿é—®
@PostMapping("/upload")
public R<String> upload(MultipartFile file) {
    String url = ossService.upload(file);  // è¿”å›æ–‡ä»¶URL
    return R.ok(url);
}
```

---

### 4.4 éƒ¨ç½²é…ç½®ç¤ºä¾‹

#### 4.4.1 Nginxé…ç½®

```nginx
upstream xzy_backend {
    # ä¼šè¯ä¿æŒï¼šåŒä¸€ç”¨æˆ·æ€»æ˜¯åˆ†é…åˆ°åŒä¸€å°æœåŠ¡å™¨
    ip_hash;

    # åç«¯æœåŠ¡å™¨åˆ—è¡¨
    server 192.168.1.101:8080 weight=1 max_fails=3 fail_timeout=30s;
    server 192.168.1.102:8080 weight=1 max_fails=3 fail_timeout=30s;

    # å¥åº·æ£€æŸ¥
    keepalive 32;
}

server {
    listen 80;
    server_name www.xiaozuyun.com;

    # å®¢æˆ·ç«¯æœ€å¤§ä¸Šä¼ æ–‡ä»¶å¤§å°
    client_max_body_size 100m;

    location / {
        proxy_pass http://xzy_backend;

        # ä¼ é€’å®¢æˆ·ç«¯çœŸå®IP
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # è¶…æ—¶é…ç½®
        proxy_connect_timeout 60s;
        proxy_read_timeout 300s;
        proxy_send_timeout 300s;

        # æ”¯æŒWebSocket
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

---

#### 4.4.2 åº”ç”¨é…ç½®ï¼ˆapplication.ymlï¼‰

```yaml
spring:
  application:
    name: xzy-admin

  # æ•°æ®åº“é…ç½®ï¼ˆä¸¤å°æœåŠ¡å™¨å…±ç”¨ï¼‰
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://192.168.1.200:3306/xzy?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8
    username: root
    password: xxxxxxxx
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5

  # Redisé…ç½®ï¼ˆå…±äº«ç¼“å­˜å’ŒSessionï¼‰
  data:
    redis:
      host: 192.168.1.200
      port: 6379
      database: 0
      password:
      timeout: 10s
      lettuce:
        pool:
          max-active: 20
          max-idle: 10
          min-idle: 5

  # Sessionå­˜å‚¨åˆ°Redis
  session:
    store-type: redis
    timeout: 1800s

# Sa-Tokené…ç½®ï¼ˆä½¿ç”¨Rediså­˜å‚¨tokenï¼‰
sa-token:
  token-name: Authorization
  token-prefix: Bearer
  timeout: 2592000  # 30å¤©
  active-timeout: -1
  # ç‹¬ç«‹Redisé…ç½®
  alone-redis:
    database: 1
    host: 192.168.1.200
    port: 6379

# OSSé…ç½®ï¼ˆæ–‡ä»¶å­˜å‚¨ï¼‰
oss:
  type: minio
  endpoint: http://192.168.1.200:9000
  accessKey: minioadmin
  secretKey: minioadmin
  bucketName: xzy-files

# SnailJobé…ç½®ï¼ˆåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ï¼‰
snail-job:
  enabled: true
  server: http://192.168.1.200:8088
  namespace: xzy
  app-name: xzy-admin

# æ—¥å¿—é…ç½®
logging:
  level:
    org.dromara: info
  file:
    name: logs/xzy-admin.log
```

---

### 4.5 éƒ¨ç½²æ–¹å¼å¯¹æ¯”

| éƒ¨ç½²æ–¹å¼ | æœåŠ¡å™¨æ•°é‡ | åº”ç”¨å®ä¾‹ | é«˜å¯ç”¨ | è´Ÿè½½å‡è¡¡ | é€‚ç”¨åœºæ™¯ |
|---------|-----------|---------|-------|---------|---------|
| **å•æœºéƒ¨ç½²** | 1å° | 1ä¸ª | âŒ æ—  | âŒ æ—  | å¼€å‘ç¯å¢ƒ |
| **é›†ç¾¤éƒ¨ç½²** | 2å°+ | 2ä¸ª+ | âœ… æœ‰ | âœ… æœ‰ | æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒ |

---

### 4.6 æ‰©å±•æ€§è¯´æ˜

æœ¬æ¶æ„è™½ç„¶ä½¿ç”¨æœ¬åœ°è°ƒç”¨ï¼Œä½†å…·å¤‡è‰¯å¥½çš„æ‰©å±•æ€§ï¼š

#### 4.6.1 æ°´å¹³æ‰©å±•ï¼ˆå¢åŠ æœåŠ¡å™¨ï¼‰

```
å½“ä¸šåŠ¡é‡å¢é•¿æ—¶ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚æœåŠ¡å™¨1â”‚  â”‚æœåŠ¡å™¨2â”‚  â”‚æœåŠ¡å™¨3â”‚  â”‚æœåŠ¡å™¨4â”‚  â† å¯ä»¥è½»æ¾å¢åŠ æœåŠ¡å™¨
â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜
    â†“         â†“         â†“         â†“
          Nginxè´Ÿè½½å‡è¡¡
```

**æ‰©å±•æ­¥éª¤**ï¼š
1. éƒ¨ç½²æ–°çš„åº”ç”¨æœåŠ¡å™¨
2. ä¿®æ”¹Nginxé…ç½®ï¼Œæ·»åŠ æ–°æœåŠ¡å™¨
3. reload Nginx

æ— éœ€ä¿®æ”¹ä»£ç ï¼

---

### 4.7 æ€»ç»“

| æ–¹é¢ | è¯´æ˜ |
|------|------|
| **è°ƒç”¨æ–¹å¼** | æœ¬åœ°APIæ¥å£è°ƒç”¨ï¼ˆSpring Beanæ³¨å…¥ï¼‰ |
| **éƒ¨ç½²æ–¹å¼** | é›†ç¾¤éƒ¨ç½²ï¼ˆå¤šå°æœåŠ¡å™¨ + Nginxè´Ÿè½½å‡è¡¡ï¼‰ |
| **ä¼šè¯ç®¡ç†** | Rediså­˜å‚¨Session/Token |
| **ç¼“å­˜ç®¡ç†** | Rediså…±äº«ç¼“å­˜ |
| **å®šæ—¶ä»»åŠ¡** | SnailJobåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ |
| **æ–‡ä»¶å­˜å‚¨** | MinIO/OSSå¯¹è±¡å­˜å‚¨ |
| **æ‰©å±•æ€§** | å¯æ°´å¹³æ‰©å±•ï¼Œè½»æ¾å¢åŠ æœåŠ¡å™¨ |

**ä¼˜åŠ¿**ï¼š
- âœ… å¼€å‘ç®€å•ï¼ˆå’Œå•ä½“åº”ç”¨ä¸€æ ·ï¼‰
- âœ… æ€§èƒ½é«˜ï¼ˆæœ¬åœ°æ–¹æ³•è°ƒç”¨ï¼‰
- âœ… é«˜å¯ç”¨ï¼ˆé›†ç¾¤éƒ¨ç½²ï¼‰
- âœ… å¯æ‰©å±•ï¼ˆåŠ æœåŠ¡å™¨å®¹æ˜“ï¼‰
- âœ… æˆæœ¬ä½ï¼ˆæ— éœ€å¾®æœåŠ¡åŸºç¡€è®¾æ–½ï¼‰

**è¿™æ˜¯æœ€é€‚åˆå°ç§Ÿäº‘é¡¹ç›®çš„æ¶æ„æ–¹æ¡ˆï¼**

---

## äº”ã€æœåŠ¡å¯åŠ¨é…ç½®

### 5.1 æœåŠ¡å¯åŠ¨æ¨¡å— pom.xml ç¤ºä¾‹

#### 5.1.1 OAæœåŠ¡ï¼ˆxzy-server-oaï¼‰

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <parent>
        <artifactId>xzy-servers</artifactId>
        <groupId>org.dromara</groupId>
        <version>${revision}</version>
    </parent>
    <modelVersion>4.0.0</modelVersion>
    <packaging>jar</packaging>
    <artifactId>xzy-server-oa</artifactId>

    <description>OAæœåŠ¡å¯åŠ¨å…¥å£</description>

    <dependencies>
        <!-- æ•°æ®åº“é©±åŠ¨ -->
        <dependency>
            <groupId>com.mysql</groupId>
            <artifactId>mysql-connector-j</artifactId>
        </dependency>

        <!-- å…¬å…±æ¨¡å— -->
        <dependency>
            <groupId>org.dromara</groupId>
            <artifactId>xzy-common-doc</artifactId>
        </dependency>

        <!-- ç³»ç»Ÿæ¨¡å—ï¼ˆå¿…éœ€ï¼‰ -->
        <dependency>
            <groupId>org.dromara</groupId>
            <artifactId>xzy-system</artifactId>
        </dependency>

        <!-- OAä¸šåŠ¡æ¨¡å— -->
        <dependency>
            <groupId>org.dromara</groupId>
            <artifactId>xzy-oa</artifactId>
        </dependency>

        <!-- ç›‘æ§å®¢æˆ·ç«¯ -->
        <dependency>
            <groupId>de.codecentric</groupId>
            <artifactId>spring-boot-admin-starter-client</artifactId>
        </dependency>
    </dependencies>

    <build>
        <finalName>${project.artifactId}</finalName>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>${spring-boot.version}</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </build>
</project>
```

#### åˆä¼™äººæœåŠ¡ï¼ˆxzy-server-partnerï¼‰

```xml
<artifactId>xzy-server-partner</artifactId>
<description>åˆä¼™äººæœåŠ¡å¯åŠ¨å…¥å£</description>

<dependencies>
    <!-- ç³»ç»Ÿæ¨¡å— -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-system</artifactId>
    </dependency>

    <!-- åˆä¼™äººæ¨¡å— -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-partner</artifactId>
    </dependency>

    <!-- è®¢å•æ¨¡å—ï¼ˆéœ€è¦æŸ¥çœ‹è®¢å•ï¼‰ -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-order</artifactId>
    </dependency>

    <!-- ç»“ç®—æ¨¡å—ï¼ˆéœ€è¦ç»“ç®—åŠŸèƒ½ï¼‰ -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-settlement</artifactId>
    </dependency>

    <!-- å®¢æˆ·æ¨¡å—ï¼ˆéœ€è¦ç®¡ç†å®¢æˆ·ï¼‰ -->
    <dependency>
        <groupId>org.dromara</groupId>
        <artifactId>xzy-customer</artifactId>
    </dependency>
</dependencies>
```

### 5.2 æœåŠ¡å¯åŠ¨ç±»

```java
package org.dromara.oa;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

/**
 * OAæœåŠ¡å¯åŠ¨ç±»
 */
@SpringBootApplication(scanBasePackages = {
    "org.dromara.common",   // å…¬å…±æ¨¡å—
    "org.dromara.system",   // ç³»ç»Ÿæ¨¡å—
    "org.dromara.oa"        // OAæ¨¡å—
})
public class OaServerApplication {

    public static void main(String[] args) {
        SpringApplication.run(OaServerApplication.class, args);
        System.out.println("(â™¥â— â€¿â— )ãƒã‚™  OAæœåŠ¡å¯åŠ¨æˆåŠŸ   áƒš(Â´Ú¡`áƒš)ã‚™");
    }
}
```

### 5.3 é…ç½®æ–‡ä»¶ï¼ˆapplication-oa.ymlï¼‰

```yaml
server:
  port: 8081

spring:
  application:
    name: xzy-oa-server

  # æ•°æ®æºé…ç½®
  datasource:
    type: com.zaxxer.hikari.HikariDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/xzy_oa?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8&autoReconnect=true&rewriteBatchedStatements=true&allowPublicKeyRetrieval=true
    username: root
    password: root

  # Redisé…ç½®
  data:
    redis:
      host: localhost
      port: 6379
      database: 1

# Sa-Tokené…ç½®
sa-token:
  # tokenåç§°
  token-name: Authorization
  # tokenå‰ç¼€
  token-prefix: Bearer
  # tokenæœ‰æ•ˆæœŸï¼ˆå•ä½ï¼šç§’ï¼‰-1è¡¨ç¤ºæ°¸ä¸è¿‡æœŸ
  timeout: 2592000
  # tokenæœ€ä½æ´»è·ƒé¢‘ç‡ï¼ˆå•ä½ï¼šç§’ï¼‰ï¼Œå¦‚æœtokenè¶…è¿‡æ­¤æ—¶é—´æ²¡æœ‰è®¿é—®ç³»ç»Ÿå°±ä¼šè¢«å†»ç»“ï¼Œé»˜è®¤-1 ä»£è¡¨ä¸é™åˆ¶
  active-timeout: -1

# æ—¥å¿—é…ç½®
logging:
  level:
    org.dromara: info
```

### 5.4 æ¡ä»¶æ³¨è§£æ§åˆ¶ç»„ä»¶åŠ è½½

```java
/**
 * OAæœåŠ¡ç‰¹æœ‰é…ç½®
 */
@Configuration
@ConditionalOnProperty(name = "xzy.service.name", havingValue = "oa")
public class OaServiceConfiguration {

    @Bean
    public OaWorkflowService oaWorkflowService() {
        return new OaWorkflowService();
    }
}
```

## å…­ã€å¼€å‘è§„èŒƒ

### 6.1 ä¾èµ–è§„èŒƒ

#### âœ… å…è®¸çš„ä¾èµ–æ–¹å¼

**é€šè¿‡APIæ¥å£ä¾èµ–**
```java
@Autowired
private ICustomerApiService customerApiService;
```

#### âŒ ç¦æ­¢çš„ä¾èµ–æ–¹å¼

1. **ç›´æ¥ä¾èµ–å…¶ä»–æ¨¡å—çš„Mapper**
```java
@Autowired
private CustomerMapper customerMapper;  // âŒ ç¦æ­¢
```

2. **ç›´æ¥ä¾èµ–å…¶ä»–æ¨¡å—çš„å®ä½“ç±»**
```java
Order order = new Order();
order.setCustomer(new Customer());  // âŒ ç¦æ­¢
```

3. **è·¨æ¨¡å—äº‹åŠ¡**
```java
@Transactional
public void createOrderAndUpdateCustomer() {
    orderService.save();
    customerService.update();  // âŒ ç¦æ­¢è·¨æ¨¡å—äº‹åŠ¡
}
```

4. **åœ¨pom.xmlä¸­ä¾èµ–å…¶ä»–æ¨¡å—çš„å®ç°**
```xml
<!-- âŒ ç¦æ­¢ä¾èµ–å…¶ä»–æ¨¡å—å®ç° -->
<dependency>
    <groupId>org.dromara</groupId>
    <artifactId>xzy-customer</artifactId>
</dependency>

<!-- âœ… åªèƒ½ä¾èµ–API -->
<dependency>
    <groupId>org.dromara</groupId>
    <artifactId>xzy-customer-api</artifactId>
</dependency>
```

### 6.2 ä»£ç è§„èŒƒ

#### APIæ¥å£å‘½åè§„èŒƒ

```java
// æ¥å£å‘½åï¼šI{æ¨¡å—å}ApiService
public interface ICustomerApiService {
    // æ–¹æ³•å‘½åï¼šget/list/query/exists/count
}

// DTOå‘½åï¼š{æ¨¡å—å}DTO
public class CustomerDTO {
    // å­—æ®µå‘½åï¼šä¸å®ä½“ä¿æŒä¸€è‡´
}

// å®ç°ç±»å‘½åï¼š{æ¨¡å—å}ApiServiceImpl
public class CustomerApiServiceImpl implements ICustomerApiService {
}
```

#### æŸ¥è¯¢ä¼˜åŒ–è§„èŒƒ

```java
// âœ… æ¨èï¼šæ‰¹é‡æŸ¥è¯¢å‡å°‘è°ƒç”¨æ¬¡æ•°
List<Long> customerIds = orders.stream()
    .map(Order::getCustomerId)
    .distinct()
    .collect(Collectors.toList());

Map<Long, CustomerDTO> customerMap = customerApiService
    .listCustomerByIds(customerIds)
    .stream()
    .collect(Collectors.toMap(CustomerDTO::getCustomerId, c -> c));

// âŒ ä¸æ¨èï¼šå¾ªç¯è°ƒç”¨
for (Order order : orders) {
    CustomerDTO customer = customerApiService.getCustomerById(order.getCustomerId());
}
```

#### å¼‚å¸¸å¤„ç†è§„èŒƒ

```java
@Override
public OrderVo getOrderDetail(Long orderId) {
    Order order = baseMapper.selectById(orderId);
    Assert.notNull(order, "è®¢å•ä¸å­˜åœ¨");

    // APIè°ƒç”¨å¢åŠ å®¹é”™å¤„ç†
    CustomerDTO customer = customerApiService.getCustomerById(order.getCustomerId());
    if (customer == null) {
        log.warn("è®¢å•å…³è”çš„å®¢æˆ·ä¸å­˜åœ¨: orderId={}, customerId={}", orderId, order.getCustomerId());
        // ä½¿ç”¨å†—ä½™æ•°æ®å…œåº•
        customer = new CustomerDTO();
        customer.setCustomerName(order.getCustomerName());
    }

    return buildOrderVo(order, customer);
}
```

## ä¸ƒã€éƒ¨ç½²æ–¹æ¡ˆ

### 7.1 å¼€å‘ç¯å¢ƒéƒ¨ç½²ï¼ˆå•ä½“æ¨¡å¼ï¼‰

```bash
# å¯åŠ¨ç®¡ç†åå°ï¼ˆåŒ…å«æ‰€æœ‰æ¨¡å—ï¼‰
java -jar xzy-admin.jar --spring.profiles.active=dev
```

### 7.2 æµ‹è¯•ç¯å¢ƒéƒ¨ç½²ï¼ˆæœåŠ¡æ‹†åˆ†ï¼‰

```bash
# åˆ†åˆ«å¯åŠ¨å„ä¸ªæœåŠ¡
java -jar xzy-server-oa.jar --spring.profiles.active=test --server.port=8081
java -jar xzy-server-user.jar --spring.profiles.active=test --server.port=8082
java -jar xzy-server-partner.jar --spring.profiles.active=test --server.port=8083
java -jar xzy-server-supply.jar --spring.profiles.active=test --server.port=8084
java -jar xzy-server-supplier.jar --spring.profiles.active=test --server.port=8085
java -jar xzy-server-risk.jar --spring.profiles.active=test --server.port=8086
```

### 7.3 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼ˆDockerï¼‰

```dockerfile
# Dockerfile
FROM openjdk:17-jdk-slim

WORKDIR /app

COPY target/xzy-server-oa.jar app.jar

EXPOSE 8081

ENV JAVA_OPTS="-Xms512m -Xmx1024m"

ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar --spring.profiles.active=prod"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  xzy-oa:
    build: ./xzy-server-oa
    ports:
      - "8081:8081"
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/xzy_oa
    depends_on:
      - mysql
      - redis

  xzy-user:
    build: ./xzy-server-user
    ports:
      - "8082:8082"
    environment:
      - SPRING_PROFILES_ACTIVE=prod
      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/xzy_user

  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: root
    volumes:
      - mysql-data:/var/lib/mysql

  redis:
    image: redis:7-alpine
    volumes:
      - redis-data:/data

volumes:
  mysql-data:
  redis-data:
```

### 7.4 æ‰“åŒ…å‘½ä»¤

```bash
# æ‰“åŒ…æ‰€æœ‰æœåŠ¡
mvn clean package -pl xzy-servers -am

# æ‰“åŒ…å•ä¸ªæœåŠ¡
mvn clean package -pl xzy-servers/xzy-server-oa -am

# è·³è¿‡æµ‹è¯•æ‰“åŒ…
mvn clean package -DskipTests
```

## å…«ã€æ³¨æ„äº‹é¡¹

### 8.1 å¼€å‘æ³¨æ„äº‹é¡¹

1. **ä¸¥æ ¼éµå®ˆåˆ†å±‚ä¾èµ–è§„èŒƒ**
   - ä¸å¾—è·¨å±‚ä¾èµ–
   - ä¸å¾—åå‘ä¾èµ–

2. **APIæ¥å£è®¾è®¡è¦ç¨³å®š**
   - æ¥å£å˜æ›´éœ€è°¨æ…
   - ä¿æŒå‘åå…¼å®¹

3. **æ•°æ®ä¸€è‡´æ€§ä¿è¯**
   - ä½¿ç”¨äº‹ä»¶é€šçŸ¥ä¿è¯æœ€ç»ˆä¸€è‡´æ€§
   - å†—ä½™æ•°æ®éœ€è¦åŒæ­¥æ›´æ–°æœºåˆ¶

4. **æ€§èƒ½ä¼˜åŒ–**
   - æ‰¹é‡æŸ¥è¯¢å‡å°‘è°ƒç”¨æ¬¡æ•°
   - ä½¿ç”¨ç¼“å­˜å‡å°‘æ•°æ®åº“æŸ¥è¯¢
   - å¼‚æ­¥å¤„ç†éæ ¸å¿ƒæµç¨‹

### 8.2 è¿ç»´æ³¨æ„äº‹é¡¹

1. **æœåŠ¡ç›‘æ§**
   - æ¥å…¥Spring Boot Admin
   - é…ç½®é“¾è·¯è¿½è¸ª

2. **æ—¥å¿—è§„èŒƒ**
   - ç»Ÿä¸€æ—¥å¿—æ ¼å¼
   - å…³é”®æ“ä½œè®°å½•æ—¥å¿—

3. **å›æ»šé¢„æ¡ˆ**
   - å‡†å¤‡å›æ»šè„šæœ¬
   - ä¿ç•™å†å²ç‰ˆæœ¬

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.5
**åˆ›å»ºæ—¶é—´**: 2025-11-13
**æœ€åæ›´æ–°**: 2025-11-17
